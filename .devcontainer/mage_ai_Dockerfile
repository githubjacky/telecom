FROM mageai/mageai:latest

ARG PYTHON_BIN=/usr/local/bin/python

# the following code are copied from mage-ai: https://github.com/mage-ai/mage-ai/blob/master/integrations/spark/Dockerfile
# Add Debian Bullseye repository
RUN echo 'deb http://deb.debian.org/debian bullseye main' > /etc/apt/sources.list.d/bullseye.list

# Install OpenJDK 11
RUN apt-get update -y && \
    apt-get install -y openjdk-11-jdk

# Remove Debian Bullseye repository
RUN rm /etc/apt/sources.list.d/bullseye.list

RUN pip install uv && \
    uv pip install --python ${PYTHON_BIN} pyspark
